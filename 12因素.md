### 12因素 ###

SaaS(Software-as-a-service):软件即服务.用户通过网络来访问软件的软件分发模型.它把软件当作一种服务来交付,它们被称为网络应用程序.

SaaS服务构建应该满足下面12种因素,这样才能实现:

    标准化流程,快速上手
    划清服务边界,提供最大的可移植性
    适合部署在云平台,节省服务器和系统管理资源
    缩减不同环境差异,便于持续交付
    可在工具,架构和开发流程不发生明显变化的前提下实现扩展

理解12因素,要基于云服务(容器)的前提来考虑,就会更好理解它们的价值点.

- 1. 基准代码

一份基准代码,多份部署

    便于代码和应用之间对应
	缩减不同环境差异
    优点是什么??
    不同部署的应用版本,代码是否要保留??

- 2. 依赖

显示声明依赖

    简化环境配置流程
	快速运行应用
	避免依赖版本冲突;

- 3. 配置

在环境变量中存储配置,让配置和代码分离.优点如下:   

	1 代码更加通用
    2 配置与代码分开管理,容易管理,可避免配置误嵌入代码库;
    3 不同环境的环境变量天然可以区分,不存在增加配置后,配置文件变多问题;

- 4. 后端服务

把后端服务当作附加资源

后端服务是指:应用依赖的通过网络调用的各种服务.如数据库,缓存等;
将后端服务当作附加资源,它不区分本地或第三方服务,只要是网络调用就是后端服务,它的优点:

    1 参数化依赖服务 所有的后端服务对于应用就是一个配置项;
    2 按需装卸依赖服务 只要修改配置文件,就可以更换后端服务;

- 5. 构建,发布,运行

严格分离构建和运行.

部署基准代码分为三个阶段:

    构建阶段:将代码仓库转化为可执行包.构建时会使用指定版本的代码,获取和打包依赖项,编译成二进制文件和资源文件;
    发布阶段:将构建结果和部署所需的配置结合,生成可运行应用;
    运行阶段:运行已发布应用.

阶段分离的优点:

    规范发布流程;
    便于提起发现应用中异常;
    加速应用启动; 
 
- 6. 进程

以一个或多个无状态进程运行应用

应用进行必须无状态且无共享.

	任何持久化数据都要存储在后端服务内,如数据库.
	内存区域或磁盘空间可以作为进程在做某种事务型操作时的缓存,因为它们不会影响应用状态.多进程间,缓存数据不共享;单进程内也会因为容器重新部署而丢弃这部分数据.
	session保持通过redis等带有过期时间的缓存来处理.极力反对hash等"粘性session",这会让应用存在状态,同时也存在服务扩展后缓存穿透的问题.

- 7. 端口绑定

通过端口绑定来提供服务

应用应完全自我加载,不依赖任何网络服务就可创建一个面向网络的服务.互联网应用通过端口绑定来提供服务.

    应用依赖更灵活.任何应用都是一个可配置的参数.
    运行更灵活.随起随用

- 8. 并发

通过进程模型进行扩展

进程是云应用的基石,它主要基于unix守护进程模型(https://adam.herokuapp.com/past/2011/5/9/applying_the_unix_process_model_to_web_apps/).

    进程无共享,水平分区,会让并发更容易添加且更健壮.

- 9. 易处理

快速启动和优雅终止可最大化健壮性

进程易处理指:进程具备快速开启和停止的能力.追求最小启动时间.追求快且优雅的停止.还要保证停止时的健壮性.

    有利于快速,弹性伸缩应用;
    加速产品迭代;
    降低停止的影响;
    保证意外发生时,可以优雅的退出.



